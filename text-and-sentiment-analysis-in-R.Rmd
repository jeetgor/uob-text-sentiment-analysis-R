---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(tidytext)
```

```{r}
text = c("To be, or not to be--that is the question:",
         "Whether 'tis nobler in the mind to suffer",
         "The slings and arrows of outrageous fortune",
         "Or to take arms against a sea of troubles",
         "And by opposing end them.")

text <- tibble(line=1:5, text=text)
text
```

```{r}
tokens <- text %>% unnest_tokens(word, text)
tokens
```

```{r}
tokens %>% count(word, sort = TRUE)
```

```{r}
lines <- readLines("https://chryswoods.com/text_analysis_r/hamlet.txt")
lines
```

```{r}
hamlet <- tibble(line=1:length(lines), text=lines)
hamlet_tokens <- hamlet %>% unnest_tokens(word, text)
hamlet_tokens %>% count(word, sort = TRUE)
```
```{r}
data(stop_words)
stop_words
```

```{r}
important_hamlet_tokens <- hamlet_tokens %>% anti_join(stop_words)
important_hamlet_tokens
```

```{r}
important_hamlet_tokens %>% count(word, sort=TRUE)
```

```{r}
hamlet %>% unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE)
```

```{r}
library(gutenbergr)
```

```{r}
grimm_tales <- gutenberg_download(2591)
grimm_tales
```

```{r}
grimm_tales %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE)
```

```{r}
counts <- grimm_tales %>%
  unnest_tokens(word, text) %>%
  anti_join(stop_words) %>%
  count(word, sort = TRUE) %>%
  filter(n > 100)

counts
```

```{r}
counts <- counts %>% mutate(word = reorder(word, n))
```

```{r}
counts %>% ggplot(aes(n, word)) + geom_col() + labs(y=NULL)
```

```{r}
sentiments <- get_sentiments("nrc")
sentiments
```

```{r}
sentiments %>% count(sentiment)
```

```{r}
grimm_tales <- gutenberg_download(2591) %>%
              unnest_tokens(word, text) %>%
              anti_join(stop_words)
grimm_tales
```

```{r}
grimm_tales_sentiments <- grimm_tales %>% inner_join(sentiments)
grimm_tales_sentiments
```

```{r}
grimm_tales_sentiments %>% 
  filter(sentiment=="positive") %>%
  count(word, sort=TRUE)
```

```{r}
grimm_tales_sentiments %>%
  filter(sentiment=="joy") %>%
  count(word) %>% 
  summarise(total=sum(n))
```

```{r}
grimm_tales_sentiments %>% count(sentiment)
```

```{r}
grimm_tales_sentiments %>%
  count(sentiment) %>%
  mutate(sentiment = reorder(sentiment, n)) %>%
  ggplot(aes(n, sentiment)) + geom_col() + labs(y=NULL)
````